# フロントエンド - ユーザー認証・会話履歴機能

## 概要
法律相談チャットボット「LawFlow」のフロントエンドに、ユーザー認証と会話履歴管理機能を実装しました。

## 主な機能

### 1. ユーザー認証
- **ゲストモード**: 従来通り、ログインなしで利用可能
- **ログイン/新規登録**: メールアドレスとパスワードで認証
- **ユーザーメニュー**: ヘッダー右上にプロフィール表示とログアウト

### 2. 会話管理
- **会話履歴サイドバー**: 過去の会話一覧を表示
- **新規会話作成**: ボタンクリックで新しい会話を開始
- **会話の編集・削除**: タイトルの変更、不要な会話の削除
- **自動保存**: ログインユーザーの会話は自動的に保存

### 3. UI/UX改善
- **レスポンシブデザイン**: モバイル対応
- **リアルタイム通信**: WebSocketによる低遅延チャット
- **ローディング表示**: 処理中の視覚的フィードバック
- **エラーハンドリング**: 分かりやすいエラー通知

## セットアップ手順

### 1. 依存パッケージのインストール

```bash
cd llm-client
npm install
```

### 2. 環境変数の設定

`.env`ファイルがない場合は作成:
```bash
echo "REACT_APP_API_URL=http://localhost:8080" > .env
```

本番環境では適切なAPIエンドポイントに変更してください。

### 3. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで http://localhost:5173 にアクセスしてください。

### 4. 本番ビルド

```bash
npm run build
```

`dist`フォルダに本番用ファイルが生成されます。

## ディレクトリ構造

```
llm-client/src/
├── components/              # UIコンポーネント
│   ├── Chat.tsx            # メインチャット画面
│   ├── Header.tsx          # ヘッダー（UserMenu含む）
│   ├── Footer.tsx          # フッター（免責事項等）
│   ├── LoginModal.tsx      # ログイン/登録モーダル
│   ├── UserMenu.tsx        # ユーザーメニュー
│   ├── ConversationSidebar.tsx  # 会話履歴サイドバー
│   └── LoadingSpinner.tsx  # ローディング表示
├── contexts/               # 状態管理
│   └── AuthContext.tsx     # 認証状態管理
├── services/               # API通信
│   ├── api.config.ts       # API設定
│   ├── auth.service.ts     # 認証API
│   └── conversation.service.ts  # 会話API
├── utils/                  # ユーティリティ
│   └── storage.ts          # トークン保存
├── hooks/                  # カスタムフック
│   ├── useChatSocket.ts    # ゲスト用WebSocket
│   └── useChatSocketAuth.ts # 認証済みWebSocket
└── App.tsx                 # メインアプリケーション
```

## 使い方

### ゲストユーザー
1. サイトにアクセスすると、ゲストとして利用可能
2. 会話履歴は保存されません
3. ブラウザを閉じると会話が失われます

### 登録ユーザー
1. 「ログイン/新規登録」ボタンをクリック
2. 新規登録またはログイン
3. 会話が自動的に保存されます
4. サイドバーから過去の会話を選択可能
5. 会話タイトルの編集、削除が可能

## 技術スタック

- **React 18**: UIフレームワーク
- **TypeScript**: 型安全な開発
- **Tailwind CSS**: スタイリング
- **React Icons**: アイコンセット
- **React Hot Toast**: 通知表示
- **Axios**: HTTP通信
- **WebSocket**: リアルタイム通信
- **js-cookie**: トークン管理

## API連携

バックエンドAPIとの通信:
- REST API: ユーザー認証、会話管理
- WebSocket: リアルタイムチャット

## 注意事項

- 既存の社名・免責事項は維持されています
- ゲストモードでも従来通り利用可能
- セキュリティのため、本番環境ではHTTPS/WSSを使用してください

## トラブルシューティング

### ログインできない
- バックエンドサーバーが起動しているか確認
- `.env`のAPI_URLが正しいか確認

### 会話が保存されない
- ログインしているか確認
- ネットワーク接続を確認

### WebSocketエラー
- バックエンドのWebSocketエンドポイントを確認
- CORSの設定を確認

## 今後の改善案

- パスワードリセット機能
- ソーシャルログイン
- 会話の検索機能
- 会話のエクスポート機能
- ダークモード対応
- PWA対応